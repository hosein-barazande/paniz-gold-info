<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡</title>
<style>
  body {
    font-family: 'Vazir', Tahoma, sans-serif;
    direction: rtl;
    background: linear-gradient(180deg, #fff8e1, #fff);
    color: #333;
    margin: 0;
    padding: 0;
  }
  header {
    background: linear-gradient(90deg, #d4af37, #b8860b);
    color: #fff;
    text-align: center;
    padding: 15px 0;
    font-size: 1.3em;
    font-weight: bold;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  .container {
    max-width: 600px;
    margin: auto;
    padding: 15px;
  }
  .price-card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    padding: 15px 20px;
    margin: 15px 0;
    transition: 0.3s;
  }
  .price-card:hover { transform: scale(1.02); }
  .price-item {
    display: flex;
    justify-content: space-between;
    border-bottom: 1px dashed #ddd;
    padding: 6px 0;
  }
  .analysis {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    padding: 15px 20px;
    margin-top: 25px;
  }
  .good { color: #388e3c; font-weight: bold; }
  .bad { color: #d32f2f; font-weight: bold; }
  .neutral { color: #f57c00; font-weight: bold; }
  .refresh-btn {
    display: block;
    width: 100%;
    background: linear-gradient(90deg, #d4af37, #b8860b);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 12px;
    font-size: 1em;
    cursor: pointer;
    transition: 0.3s;
    margin-top: 20px;
  }
  .refresh-btn:hover {
    background: linear-gradient(90deg, #b8860b, #d4af37);
  }
  footer {
    text-align: center;
    color: #999;
    font-size: 0.8em;
    padding: 15px 0 30px;
  }
</style>
</head>
<body>

<header>ğŸ“Š Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡</header>

<div class="container">
  <div class="price-card">
    <h3>Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</h3>
    <div class="price-item"><span>Ø·Ù„Ø§ÛŒ Û±Û¸ Ø¹ÛŒØ§Ø±:</span> <span id="gold18">...</span></div>
    <div class="price-item"><span>Ø·Ù„Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ (Ø§ÙˆÙ†Ø³):</span> <span id="goldWorld">...</span></div>
    <div class="price-item"><span>Ø³Ú©Ù‡ Ø§Ù…Ø§Ù…ÛŒ:</span> <span id="sekeb">...</span></div>
    <div class="price-item"><span>Ø³Ú©Ù‡ Ø¨Ù‡Ø§Ø± Ø¢Ø²Ø§Ø¯ÛŒ:</span> <span id="bahar">...</span></div>
    <div class="price-item"><span>Ù†ÛŒÙ… Ø³Ú©Ù‡:</span> <span id="nim">...</span></div>
    <div class="price-item"><span>Ø±Ø¨Ø¹ Ø³Ú©Ù‡:</span> <span id="rob">...</span></div>
  </div>

  <div class="analysis">
    <h3>ØªØ­Ù„ÛŒÙ„ Ø§Ù…Ø±ÙˆØ²</h3>
    <p id="goldAnalysis">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª...</p>
    <p id="coinAdvice"></p>
  </div>

  <button class="refresh-btn" onclick="getGoldData()">ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø³ØªÛŒ</button>

  <footer>Â© 2025 Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡ | Ø­Ø³ÛŒÙ† Ø¨Ø±Ø§Ø²Ù†Ø¯Ù‡</footer>
</div>

<script>
// ğŸŒ Ø¢Ø¯Ø±Ø³ API Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù¾Ø±Ø§Ú©Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯ÙˆØ± Ø²Ø¯Ù† CORS
const apiUrl = "https://corsproxy.io/?https://api.tgju.org/v1/market/summary";

// ğŸ¯ Ú¯Ø±ÙØªÙ† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ Ø§Ø² ØµÙØ­Ù‡
const iranGoldElem = document.getElementById("iran-gold");
const worldGoldElem = document.getElementById("world-gold");
const coinListElem = document.getElementById("coins");
const suggestionElem = document.getElementById("suggestion");

// âš™ï¸ ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
async function fetchGoldData() {
  try {
    // â³ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² API
    const response = await fetch(apiUrl);
    const json = await response.json();

    const data = json.data;

    // ğŸŸ¡ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ÛŒ Ø§ÛŒØ±Ø§Ù† (Û±Û¸ Ø¹ÛŒØ§Ø±)
    const iranGold = data["geram18"]["p"];
    iranGoldElem.textContent = `ğŸŸ¡ ${iranGold} ØªÙˆÙ…Ø§Ù†`;

    // ğŸŒ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ (Ø§ÙˆÙ†Ø³)
    const worldGold = data["ons"]["p"];
    worldGoldElem.textContent = `ğŸŒ ${worldGold} Ø¯Ù„Ø§Ø±`;

    // ğŸ’° Ù„ÛŒØ³Øª Ø³Ú©Ù‡â€ŒÙ‡Ø§
    const coins = [
      { name: "Ø³Ú©Ù‡ Ø¨Ù‡Ø§Ø± Ø¢Ø²Ø§Ø¯ÛŒ", key: "sekebahar" },
      { name: "Ø³Ú©Ù‡ Ø§Ù…Ø§Ù…ÛŒ", key: "sekeemami" },
      { name: "Ù†ÛŒÙ… Ø³Ú©Ù‡", key: "nim" },
      { name: "Ø±Ø¨Ø¹ Ø³Ú©Ù‡", key: "rob" },
      { name: "Ø³Ú©Ù‡ Ú¯Ø±Ù…ÛŒ", key: "gerami" },
    ];

    // ğŸª™ Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª Ø³Ú©Ù‡â€ŒÙ‡Ø§
    coinListElem.innerHTML = coins
      .map(c => {
        const coin = data[c.key];
        return `<li>ğŸ’° ${c.name}: ${coin ? coin.p + " ØªÙˆÙ…Ø§Ù†" : "âŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª"}</li>`;
      })
      .join("");

    // ğŸ“Š Ù…Ø­Ø§Ø³Ø¨Ù‡ ØµØ±ÙÙ‡ Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ø®Ø±ÛŒØ¯ Ø·Ù„Ø§
    checkIfBuyingIsGood(parseFloat(iranGold.replace(/,/g, "")), parseFloat(worldGold.replace(/,/g, "")));

  } catch (err) {
    console.error("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:", err);
    iranGoldElem.textContent = "âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§";
    worldGoldElem.textContent = "âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§";
    coinListElem.innerHTML = "<li>âŒ Ø§Ù…Ú©Ø§Ù† Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</li>";
    suggestionElem.textContent = "ğŸš« Ø§Ù…Ú©Ø§Ù† Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.";
  }
}

// ğŸ“ˆ ØªØ§Ø¨Ø¹ Ù…Ø­Ø§Ø³Ø¨Ù‡ ØµØ±ÙÙ‡ Ø®Ø±ÛŒØ¯ Ø·Ù„Ø§
function checkIfBuyingIsGood(iranPrice, worldPrice) {
  // ğŸ’µ Ù‡Ø± Ø§ÙˆÙ†Ø³ Ø·Ù„Ø§ â‰ˆ 31.1035 Ú¯Ø±Ù…
  const worldPricePerGramDollar = worldPrice / 31.1035;

  // Ù†Ø±Ø® ØªÙ‚Ø±ÛŒØ¨ÛŒ Ø¯Ù„Ø§Ø± (Ù‚Ø§Ø¨Ù„ ØªØºÛŒÛŒØ±)
  const dollarRate = 60000;

  // ğŸ’° Ù‚ÛŒÙ…Øª Ù‡Ø± Ú¯Ø±Ù… Ø·Ù„Ø§ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø± Ø¬Ù‡Ø§Ù†ÛŒ Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†
  const worldPricePerGramToman = worldPricePerGramDollar * dollarRate;

  // ğŸ” Ø§Ø®ØªÙ„Ø§Ù Ù‚ÛŒÙ…Øª Ø§ÛŒØ±Ø§Ù† Ø¨Ø§ Ø¬Ù‡Ø§Ù†ÛŒ
  const diff = iranPrice - worldPricePerGramToman;
  const percent = (diff / worldPricePerGramToman) * 100;

  let suggestion = "";

  // ğŸ’¡ ØªØ­Ù„ÛŒÙ„ Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ø®ØªÙ„Ø§Ù
  if (percent > 15) {
    suggestion = "ğŸš« Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø®Ø±ÛŒØ¯ Ø·Ù„Ø§ Ø¨Ù‡ ØµØ±ÙÙ‡ Ù†ÛŒØ³Øª.";
  } else if (percent > 5) {
    suggestion = "âš ï¸ Ø®Ø±ÛŒØ¯ Ø·Ù„Ø§ Ø¨Ø§ Ø§Ø­ØªÛŒØ§Ø· Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯.";
  } else {
    suggestion = "âœ… Ø²Ù…Ø§Ù† Ø®ÙˆØ¨ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø·Ù„Ø§ Ø§Ø³Øª!";
  }

  suggestionElem.textContent = suggestion;
}

// ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø± Û² Ø¯Ù‚ÛŒÙ‚Ù‡
fetchGoldData();
setInterval(fetchGoldData, 120000);

</script>

</body>
</html>
